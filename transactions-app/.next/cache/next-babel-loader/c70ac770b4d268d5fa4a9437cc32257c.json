{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useCallback, useEffect } from 'react';\nimport axios from 'axios';\nimport { API, graphqlOperation } from 'aws-amplify';\nimport gql from 'graphql-tag';\nimport { useQuery } from '@apollo/client';\nimport { Modal, Thumbnail, Checkbox, TextStyle, TextField } from '@shopify/polaris';\nimport { Table, Header, Icon } from 'semantic-ui-react';\nimport { toCurrency, formatDate } from '../utils/helper';\nimport config from '../aws-exports';\nimport { getBranchById } from '../graphql/queries';\nAPI.configure(config);\n\nvar BranchRow = function BranchRow(_ref) {\n  var product = _ref.product,\n      state = _ref.state,\n      setState = _ref.setState,\n      branchId = _ref.branchId,\n      branchInfo = _ref.branchInfo,\n      rowId = _ref.rowId,\n      setRowId = _ref.setRowId;\n\n  var _useState = useState({\n    description: product.node.description,\n    id: product.node.id,\n    image: product.node.images.edges[0] ? product.node.images.edges[0].node.originalSrc : '',\n    tags: product.node.tags,\n    title: product.node.title,\n    variants: {\n      id: product.node.variants.edges[0].node.id,\n      price: product.node.variants.edges[0].node.price\n    }\n  }),\n      fetchedProduct = _useState[0],\n      setFetchedProduct = _useState[1]; // const [branchInfo, setBranchInfo] = useState('')\n  // const [rowId, setRowId] = useState('')\n\n\n  var _useState2 = useState(null),\n      searchValue = _useState2[0],\n      setSearchValue = _useState2[1];\n\n  var _useState3 = useState(''),\n      bonus = _useState3[0],\n      setBonus = _useState3[1];\n\n  var _useState4 = useState(false),\n      checked = _useState4[0],\n      setChecked = _useState4[1];\n\n  var handleSearchInput = useCallback(function (newValue) {\n    return setSearchValue(newValue);\n  }, []);\n  var handleBonus = useCallback(function (value) {\n    setBonus(value);\n    fetchedProduct.tags = [value];\n    setFetchedProduct(fetchedProduct);\n  }, []);\n\n  var compareProduct = function compareProduct() {\n    var comparedProduct = branchInfo.branchProducts.items.filter(function (branchProduct) {\n      return branchProduct.productId === fetchedProduct.id;\n    });\n    console.log('Here is your compared product', comparedProduct);\n\n    if (!comparedProduct || comparedProduct === undefined) {\n      return;\n    }\n\n    setBonus(comparedProduct[0] ? comparedProduct[0].tags[0] : '');\n    return;\n  }; // const getBranch = async () => {\n  //     try {\n  //         const branch = await API.graphql(graphqlOperation(getBranchById, { id: branchId }))\n  //         setBranchInfo(branch.data.getBranch)\n  //         setRowId(\n  //             branch.data.getBranch.branchProducts.items\n  //                 .map((item) => item.productId)\n  //                 .filter((productId) => productId === fetchedProduct.id)[0]\n  //         )\n  //         setState({\n  //             products: [\n  //                 ...state.products,\n  //                 ...branch.data.getBranch.branchProducts.items.filter(\n  //                     (product) => product.productId === fetchedProduct.id\n  //                 )[0]\n  //             ]\n  //         })\n  //         compareProduct(branch.data.getBranch.branchProducts)\n  //     } catch (error) {\n  //         console.log(error)\n  //     }\n  // }\n\n\n  useEffect(function () {\n    console.log('Row id from useEffect', branchInfo.branchProducts.items.map(function (item) {\n      return item.productId;\n    }).filter(function (productId) {\n      return productId === fetchedProduct.id;\n    })[0]); // setRowId([...rowId, branchInfo.branchProducts.items\n    //         .map((item) => item.productId)\n    //         .filter((productId) => productId === fetchedProduct.id)[0]])\n\n    compareProduct();\n  }, [product, branchInfo]);\n  console.log('Fetched product', fetchedProduct);\n  console.log('State from BranchRow', state);\n  console.log('Row id from BranchRow', rowId);\n  return __jsx(Table.Row, {\n    key: fetchedProduct.id\n  }, __jsx(Table.Cell, null, __jsx(Header, {\n    as: \"h4\",\n    image: true,\n    className: \"product-header\"\n  }, __jsx(Checkbox, {\n    checked: rowId.includes(fetchedProduct.id) && true,\n    onChange: function onChange() {\n      if (rowId.includes(fetchedProduct.id)) {\n        setRowId(rowId.filter(function (id) {\n          return id !== fetchedProduct.id;\n        }));\n        setState({\n          products: state.products.filter(function (filteredProduct) {\n            return filteredProduct.id !== fetchedProduct.id;\n          })\n        });\n      } else {\n        setRowId([].concat(_toConsumableArray(rowId), [fetchedProduct.id]));\n        setState(_objectSpread(_objectSpread({}, state), {}, {\n          products: [].concat(_toConsumableArray(state.products), [fetchedProduct])\n        }));\n      }\n    }\n  }), __jsx(Thumbnail, {\n    source: fetchedProduct.image,\n    size: \"small\",\n    alt: \"\"\n  }), __jsx(Header.Content, null, fetchedProduct.title))), __jsx(Table.Cell, {\n    textAlign: \"center\"\n  }, __jsx(TextStyle, {\n    variation: \"subdued\"\n  }, fetchedProduct.variants && toCurrency(fetchedProduct.variants.price))), __jsx(Table.Cell, null, __jsx(TextField, {\n    id: \"percentage-input\",\n    placeholder: \"Bonus Percentage\",\n    value: bonus,\n    onChange: handleBonus,\n    prefix: __jsx(Icon, {\n      name: \"percent\"\n    }),\n    disabled: !rowId.includes(fetchedProduct.id)\n  })));\n};\n\nexport default BranchRow;","map":null,"metadata":{},"sourceType":"module"}