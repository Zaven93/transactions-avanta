{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n    mutation deleteBranch($input: DeleteBranchInput!) {\\n        deleteBranch(input: $input) {\\n            id\\n        }\\n    }\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n    subscription onDeleteBranch {\\n        onDeleteBranch {\\n            id\\n        }\\n    }\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n    subscription onCreateBranch {\\n        onCreateBranch {\\n            adminId\\n            branchName\\n            id\\n            createdAt\\n        }\\n    }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n    query listBranchs {\\n        listBranchs {\\n            items {\\n                adminId\\n                branchName\\n                branchUsername\\n                createdAt\\n                id\\n                branchProducts {\\n                    items {\\n                        branchId\\n                        createdAt\\n                        id\\n                        productId\\n                        tags\\n                        updatedAt\\n                    }\\n                }\\n            }\\n        }\\n    }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport AWS from 'aws-sdk';\nimport { Auth, API, graphqlOperation } from 'aws-amplify';\nimport createApp from '@shopify/app-bridge';\nimport { Redirect } from '@shopify/app-bridge/actions';\nimport gql from 'graphql-tag';\nimport { v4 as uuidv4 } from 'uuid';\nimport { Page, Button, Modal, Form, FormLayout, TextField, Badge } from '@shopify/polaris';\nimport { Table, Popup, Header, Icon } from 'semantic-ui-react';\nimport ProductList from './ProductsList';\nimport { formatDate } from '../utils/helper';\nimport config from '../aws-exports';\nimport BranchProducts from './BranchProducts';\nimport AdminBranchInfo from '../components/AdminBranchInfo';\nAPI.configure(config);\nAWS.config.update({\n  accessKeyId: 'AKIAI53OMMWOAP5X3K5Q',\n  secretAccessKey: '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',\n  region: 'us-east-1'\n});\nvar cognito = new AWS.CognitoIdentityServiceProvider();\nvar listBranchs = gql(_templateObject());\nvar onCreateBranchSubscription = gql(_templateObject2());\nvar onDeleteBranchSubscription = gql(_templateObject3());\nvar removeBranch = gql(_templateObject4());\n\nvar BranchList = function BranchList(_ref) {\n  _s();\n\n  var setBranchId = _ref.setBranchId,\n      branchId = _ref.branchId;\n\n  var _useState = useState(false),\n      active = _useState[0],\n      setActive = _useState[1];\n\n  var _useState2 = useState(''),\n      branches = _useState2[0],\n      setBranches = _useState2[1];\n\n  var _useState3 = useState(''),\n      branchName = _useState3[0],\n      setBranchName = _useState3[1];\n\n  var _useState4 = useState(''),\n      productBranchId = _useState4[0],\n      setProductBranchId = _useState4[1];\n\n  var _useState5 = useState(''),\n      newCreatedBranch = _useState5[0],\n      setNewCreatedBranch = _useState5[1];\n\n  var app = createApp({\n    apiKey: '3b01063bac3031d13101100ef3e44fd5',\n    shopOrigin: 'transactions-avanta.myshopify.com'\n  });\n  var redirect = Redirect.create(app);\n\n  var handleChange = function handleChange() {\n    setActive(!active);\n  };\n\n  var fetchBranches = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var getBranches;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return API.graphql(graphqlOperation(listBranchs));\n\n            case 3:\n              getBranches = _context.sent;\n              setBranches(getBranches.data);\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7]]);\n    }));\n\n    return function fetchBranches() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var deleteBranch = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id) {\n      var deletedBranch;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return API.graphql(graphqlOperation(removeBranch, {\n                input: {\n                  id: id\n                }\n              }));\n\n            case 3:\n              deletedBranch = _context2.sent;\n              console.log('Deleted branch', deletedBranch);\n              _context2.next = 10;\n              break;\n\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(_context2.t0);\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 7]]);\n    }));\n\n    return function deleteBranch(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var deleteUserFromCognito = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(username) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return cognito.adminDeleteUser({\n                UserPoolId: 'us-east-1_IfrnnzGFR',\n                Username: username\n              }).promise();\n\n            case 3:\n              _context3.next = 8;\n              break;\n\n            case 5:\n              _context3.prev = 5;\n              _context3.t0 = _context3[\"catch\"](0);\n              console.log(_context3.t0);\n\n            case 8:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[0, 5]]);\n    }));\n\n    return function deleteUserFromCognito(_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    fetchBranches();\n    API.graphql(graphqlOperation(onCreateBranchSubscription)).subscribe({\n      next: function next(createdBranch) {\n        setNewCreatedBranch(createdBranch);\n      }\n    });\n    API.graphql(graphqlOperation(onDeleteBranchSubscription)).subscribe({\n      next: function next(deletedBranch) {\n        setNewCreatedBranch(deletedBranch);\n      }\n    });\n  }, [newCreatedBranch]);\n  console.log('Branches from Branch list', branches);\n  return __jsx(React.Fragment, null, __jsx(Table, {\n    selectable: true,\n    celled: true\n  }, __jsx(Table.Header, null, __jsx(Table.Row, null, __jsx(Table.HeaderCell, null, \"Branch Name\"), __jsx(Table.HeaderCell, {\n    textAlign: \"center\"\n  }, \"Created At\"), __jsx(Table.HeaderCell, {\n    textAlign: \"center\"\n  }, \"Actions\"))), __jsx(Table.Body, null, branches && branches.listBranchs.items.map(function (item) {\n    return __jsx(Table.Row, {\n      key: item.id\n    }, __jsx(Table.Cell, null, __jsx(Button, {\n      primary: true,\n      onClick: function onClick() {\n        setBranchId(item.id); // redirect.dispatch(\n        //     Redirect.Action.ADMIN_PATH,\n        //     `/apps/3b01063bac3031d13101100ef3e44fd5/branch/${item.id}`\n        // )\n      }\n    }, __jsx(Icon, {\n      name: \"code branch\"\n    }), \" \", item.branchName)), __jsx(Table.Cell, {\n      textAlign: \"center\"\n    }, formatDate(item.createdAt)), __jsx(Table.Cell, {\n      textAlign: \"center\",\n      className: \"branch-actions\"\n    }, __jsx(Popup, {\n      content: \"Edit branch\",\n      trigger: __jsx(Icon, {\n        onClick: function onClick() {\n          setProductBranchId(item.id);\n          setBranchName(item.branchName);\n          handleChange();\n        },\n        className: \"edit-branch\",\n        name: \"edit outline\"\n      })\n    }), __jsx(Popup, {\n      content: \"Delete Branch\",\n      trigger: __jsx(Icon, {\n        className: \"remove-branch\",\n        name: \"trash alternate\",\n        onClick: function onClick() {\n          deleteBranch(item.id);\n          deleteUserFromCognito(item.branchUsername);\n        }\n      })\n    })));\n  }))), __jsx(BranchProducts, {\n    branchName: branchName,\n    branchId: productBranchId,\n    active: active,\n    handleChange: handleChange\n  }));\n};\n\n_s(BranchList, \"kGZRqAoNNLY5YDRoaJr29kD+3Os=\");\n\n_c = BranchList;\nexport default BranchList;\n\nvar _c;\n\n$RefreshReg$(_c, \"BranchList\");","map":{"version":3,"sources":["/var/www/transactions-avanta/components/BranchList.js"],"names":["React","useState","useEffect","useCallback","AWS","Auth","API","graphqlOperation","createApp","Redirect","gql","v4","uuidv4","Page","Button","Modal","Form","FormLayout","TextField","Badge","Table","Popup","Header","Icon","ProductList","formatDate","config","BranchProducts","AdminBranchInfo","configure","update","accessKeyId","secretAccessKey","region","cognito","CognitoIdentityServiceProvider","listBranchs","onCreateBranchSubscription","onDeleteBranchSubscription","removeBranch","BranchList","setBranchId","branchId","active","setActive","branches","setBranches","branchName","setBranchName","productBranchId","setProductBranchId","newCreatedBranch","setNewCreatedBranch","app","apiKey","shopOrigin","redirect","create","handleChange","fetchBranches","graphql","getBranches","data","console","log","deleteBranch","id","input","deletedBranch","deleteUserFromCognito","username","adminDeleteUser","UserPoolId","Username","promise","subscribe","next","createdBranch","items","map","item","createdAt","branchUsername"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react'\nimport AWS from 'aws-sdk'\nimport { Auth, API, graphqlOperation } from 'aws-amplify'\nimport createApp from '@shopify/app-bridge'\nimport { Redirect } from '@shopify/app-bridge/actions'\nimport gql from 'graphql-tag'\nimport { v4 as uuidv4 } from 'uuid'\nimport { Page, Button, Modal, Form, FormLayout, TextField, Badge } from '@shopify/polaris'\nimport { Table, Popup, Header, Icon } from 'semantic-ui-react'\nimport ProductList from './ProductsList'\nimport { formatDate } from '../utils/helper'\nimport config from '../aws-exports'\nimport BranchProducts from './BranchProducts'\nimport AdminBranchInfo from '../components/AdminBranchInfo'\n\nAPI.configure(config)\n\nAWS.config.update({\n    accessKeyId: 'AKIAI53OMMWOAP5X3K5Q',\n    secretAccessKey: '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',\n    region: 'us-east-1'\n})\n\nconst cognito = new AWS.CognitoIdentityServiceProvider()\n\nconst listBranchs = gql`\n    query listBranchs {\n        listBranchs {\n            items {\n                adminId\n                branchName\n                branchUsername\n                createdAt\n                id\n                branchProducts {\n                    items {\n                        branchId\n                        createdAt\n                        id\n                        productId\n                        tags\n                        updatedAt\n                    }\n                }\n            }\n        }\n    }\n`\nconst onCreateBranchSubscription = gql`\n    subscription onCreateBranch {\n        onCreateBranch {\n            adminId\n            branchName\n            id\n            createdAt\n        }\n    }\n`\n\nconst onDeleteBranchSubscription = gql`\n    subscription onDeleteBranch {\n        onDeleteBranch {\n            id\n        }\n    }\n`\n\nconst removeBranch = gql`\n    mutation deleteBranch($input: DeleteBranchInput!) {\n        deleteBranch(input: $input) {\n            id\n        }\n    }\n`\n\nconst BranchList = ({ setBranchId, branchId }) => {\n    const [active, setActive] = useState(false)\n    const [branches, setBranches] = useState('')\n    const [branchName, setBranchName] = useState('')\n    const [productBranchId, setProductBranchId] = useState('')\n    const [newCreatedBranch, setNewCreatedBranch] = useState('')\n\n    const app = createApp({\n        apiKey: '3b01063bac3031d13101100ef3e44fd5',\n        shopOrigin: 'transactions-avanta.myshopify.com'\n    })\n\n    const redirect = Redirect.create(app)\n\n    const handleChange = () => {\n        setActive(!active)\n    }\n\n    const fetchBranches = async () => {\n        try {\n            const getBranches = await API.graphql(graphqlOperation(listBranchs))\n            setBranches(getBranches.data)\n        } catch (error) {\n            console.log(error)\n        }\n    }\n\n    const deleteBranch = async (id) => {\n        try {\n            const deletedBranch = await API.graphql(\n                graphqlOperation(removeBranch, { input: { id } })\n            )\n            console.log('Deleted branch', deletedBranch)\n        } catch (error) {\n            console.log(error)\n        }\n    }\n\n    const deleteUserFromCognito = async (username) => {\n        try {\n            await cognito\n                .adminDeleteUser({\n                    UserPoolId: 'us-east-1_IfrnnzGFR',\n                    Username: username\n                })\n                .promise()\n        } catch (error) {\n            console.log(error)\n        }\n    }\n\n    useEffect(() => {\n        fetchBranches()\n        API.graphql(graphqlOperation(onCreateBranchSubscription)).subscribe({\n            next: (createdBranch) => {\n                setNewCreatedBranch(createdBranch)\n            }\n        })\n        API.graphql(graphqlOperation(onDeleteBranchSubscription)).subscribe({\n            next: (deletedBranch) => {\n                setNewCreatedBranch(deletedBranch)\n            }\n        })\n    }, [newCreatedBranch])\n\n    console.log('Branches from Branch list', branches)\n\n    return (\n        <>\n            <Table selectable celled>\n                <Table.Header>\n                    <Table.Row>\n                        <Table.HeaderCell>Branch Name</Table.HeaderCell>\n                        <Table.HeaderCell textAlign=\"center\">Created At</Table.HeaderCell>\n                        <Table.HeaderCell textAlign=\"center\">Actions</Table.HeaderCell>\n                    </Table.Row>\n                </Table.Header>\n                <Table.Body>\n                    {branches &&\n                        branches.listBranchs.items.map((item) => (\n                            <Table.Row key={item.id}>\n                                <Table.Cell>\n                                    {/* <Badge size=\"medium\" status=\"info\">\n                                        {item.branchName}\n                                    </Badge> */}\n                                    <Button\n                                        primary\n                                        onClick={() => {\n                                            setBranchId(item.id)\n                                            // redirect.dispatch(\n                                            //     Redirect.Action.ADMIN_PATH,\n                                            //     `/apps/3b01063bac3031d13101100ef3e44fd5/branch/${item.id}`\n                                            // )\n                                        }}>\n                                        <Icon name=\"code branch\" /> {item.branchName}\n                                    </Button>\n                                </Table.Cell>\n                                <Table.Cell textAlign=\"center\">\n                                    {formatDate(item.createdAt)}\n                                </Table.Cell>\n                                <Table.Cell textAlign=\"center\" className=\"branch-actions\">\n                                    <Popup\n                                        content=\"Edit branch\"\n                                        trigger={\n                                            <Icon\n                                                onClick={() => {\n                                                    setProductBranchId(item.id)\n                                                    setBranchName(item.branchName)\n                                                    handleChange()\n                                                }}\n                                                className=\"edit-branch\"\n                                                name=\"edit outline\"\n                                            />\n                                        }\n                                    />\n                                    <Popup\n                                        content=\"Delete Branch\"\n                                        trigger={\n                                            <Icon\n                                                className=\"remove-branch\"\n                                                name=\"trash alternate\"\n                                                onClick={() => {\n                                                    deleteBranch(item.id)\n                                                    deleteUserFromCognito(item.branchUsername)\n                                                }}\n                                            />\n                                        }\n                                    />\n                                </Table.Cell>\n                            </Table.Row>\n                        ))}\n                </Table.Body>\n            </Table>\n            <BranchProducts\n                branchName={branchName}\n                branchId={productBranchId}\n                active={active}\n                handleChange={handleChange}\n            />\n        </>\n    )\n}\n\nexport default BranchList\n"]},"metadata":{},"sourceType":"module"}